using Nemerle;
using Nemerle.Assertions;
using Nemerle.Collections;
using Nemerle.Text;
using Nemerle.Utility;

using System;
using System.IO;
using System.Collections.Generic;
using System.Linq;

namespace Nemerle.Compiler.Test
{
  /// <summary>
  /// Description of DefaultColorizedOutputWriter.
  /// </summary>
  internal sealed class DefaultColorizedOutputWriter : ColorizedOutputWriter
  {
    public this([NotNull] output : TextWriter)
    {
      _output = output;
    }

    public override Write(color : ConsoleColor?, text : string) : void
    {
      if(color.HasValue)
      {
        def oldColor = Console.ForegroundColor;
        Console.ForegroundColor = color.GetValueOrDefault();
        try _output.Write(text);
        finally Console.ForegroundColor = oldColor;
      }
      else _output.Write(text);
    }

    public override WriteLine(color : ConsoleColor?, text : string) : void
    {
      if(color.HasValue)
      {
        def oldColor = Console.ForegroundColor;
        Console.ForegroundColor = color.GetValueOrDefault();
        try _output.WriteLine(text);
        finally Console.ForegroundColor = oldColor;
      }
      else _output.WriteLine(text);
    }

    private _output : TextWriter;
  }
}
